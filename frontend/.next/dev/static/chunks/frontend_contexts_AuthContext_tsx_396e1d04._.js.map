{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["A:/PROJECTS/learning-module-system/frontend/contexts/AuthContext.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { createContext, useContext, useState, useEffect, ReactNode } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\n\r\ninterface User {\r\n  id: string\r\n  name: string\r\n  email: string\r\n  faculty?: string\r\n  course?: string\r\n  picture?: string\r\n  provider?: 'email' | 'google'\r\n}\r\n\r\ninterface AuthContextType {\r\n  user: User | null\r\n  login: (email: string, password: string) => Promise<void>\r\n  loginWithGoogle: () => Promise<void>\r\n  logout: () => void\r\n  isLoading: boolean\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext)\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider')\r\n  }\r\n  return context\r\n}\r\n\r\ninterface AuthProviderProps {\r\n  children: ReactNode\r\n}\r\n\r\nexport function AuthProvider({ children }: AuthProviderProps) {\r\n  const [user, setUser] = useState<User | null>(null)\r\n  const [isLoading, setIsLoading] = useState(true)\r\n  const router = useRouter()\r\n\r\n  useEffect(() => {\r\n    // Check for existing session on mount\r\n    const savedUser = localStorage.getItem('user')\r\n    if (savedUser) {\r\n      setUser(JSON.parse(savedUser))\r\n    }\r\n    setIsLoading(false)\r\n  }, [])\r\n\r\n  const login = async (email: string, password: string) => {\r\n    setIsLoading(true)\r\n    \r\n    // Simulate authentication\r\n    return new Promise<void>((resolve, reject) => {\r\n      setTimeout(() => {\r\n        if (email && password) {\r\n          const mockUser: User = {\r\n            id: 'user-1',\r\n            name: 'John Doe',\r\n            email: email,\r\n            faculty: 'Engineering',\r\n            course: 'Computer Science'\r\n          }\r\n          \r\n          setUser(mockUser)\r\n          localStorage.setItem('user', JSON.stringify(mockUser))\r\n          setIsLoading(false)\r\n          resolve()\r\n        } else {\r\n          setIsLoading(false)\r\n          reject(new Error('Invalid credentials'))\r\n        }\r\n      }, 1500)\r\n    })\r\n  }\r\n\r\n  const loginWithGoogle = async () => {\r\n    setIsLoading(true)\r\n    \r\n    try {\r\n      // Load Google API\r\n      await new Promise((resolve, reject) => {\r\n        const script = document.createElement('script')\r\n        script.src = 'https://accounts.google.com/gsi/client'\r\n        script.onload = resolve\r\n        script.onerror = reject\r\n        document.head.appendChild(script)\r\n      })\r\n\r\n      // Initialize Google Sign-In\r\n      const google = (window as any).google\r\n      if (!google) {\r\n        throw new Error('Google API not loaded')\r\n      }\r\n\r\n      // Trigger Google OAuth flow\r\n      const tokenClient = google.accounts.oauth2.initTokenClient({\r\n        client_id: process.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID || '7329025228-q8u70qbfjb75c3d3o16lo6nj605npots.apps.googleusercontent.com',\r\n        scope: 'openid email profile',\r\n        callback: async (tokenResponse: any) => {\r\n          if (tokenResponse.access_token) {\r\n            try {\r\n              // Send token to your backend for verification\r\n              const response = await fetch('/api/auth/google', {\r\n                method: 'POST',\r\n                headers: {\r\n                  'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({ token: tokenResponse.access_token }),\r\n              })\r\n\r\n              if (!response.ok) {\r\n                throw new Error('Google authentication failed')\r\n              }\r\n\r\n              const { user } = await response.json()\r\n              \r\n              const appUser: User = {\r\n                id: user.id,\r\n                name: user.name,\r\n                email: user.email,\r\n                picture: user.picture,\r\n                provider: 'google',\r\n                faculty: 'Not specified',\r\n                course: 'Not specified'\r\n              }\r\n              \r\n              setUser(appUser)\r\n              localStorage.setItem('user', JSON.stringify(appUser))\r\n              setIsLoading(false)\r\n            } catch (error) {\r\n              console.error('Google auth error:', error)\r\n              setIsLoading(false)\r\n              throw error\r\n            }\r\n          } else {\r\n            setIsLoading(false)\r\n            throw new Error('No access token received')\r\n          }\r\n        },\r\n      })\r\n\r\n      tokenClient.requestAccessToken()\r\n    } catch (error) {\r\n      setIsLoading(false)\r\n      throw error\r\n    }\r\n  }\r\n\r\n  const logout = () => {\r\n    setUser(null)\r\n    localStorage.removeItem('user')\r\n    router.push('/auth')\r\n  }\r\n\r\n  const value: AuthContextType = {\r\n    user,\r\n    login,\r\n    loginWithGoogle,\r\n    logout,\r\n    isLoading\r\n  }\r\n\r\n  return (\r\n    <AuthContext.Provider value={value}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  )\r\n}\r\n"],"names":["c","_c","createContext","useContext","useState","useEffect","ReactNode","useRouter","User","id","name","email","faculty","course","picture","provider","AuthContextType","user","login","password","Promise","loginWithGoogle","logout","isLoading","AuthContext","undefined","useAuth","$","$i","Symbol","for","context","Error","AuthProviderProps","children","AuthProvider","setUser","setIsLoading","router","savedUser","localStorage","getItem","JSON","parse","resolve","reject","setTimeout","mockUser","setItem","stringify","script","document","createElement","src","onload","onerror","head","appendChild","google","window","tokenClient","accounts","oauth2","initTokenClient","client_id","process","env","NEXT_PUBLIC_GOOGLE_CLIENT_ID","scope","callback","tokenResponse","access_token","response","fetch","method","headers","body","token","ok","json","appUser","error","console","requestAccessToken","removeItem","push","value"],"mappings":"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","ignoreList":[]}}]
}